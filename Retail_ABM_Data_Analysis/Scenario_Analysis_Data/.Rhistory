mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario_0 = median(scenario_0),
scenario_1 = median(scenario_1),
scenario_2 = median(scenario_2),
scenario_3 = median(scenario_3),
scenario_4 = median(scenario_4),
scenario_5 = median(scenario_5),
scenario_6 = median(scenario_6),
scenario_7 = median(scenario_7),
scenario_8 = median(scenario_8),
scenario_9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev %>% view()
mean_prev = prev_df %>%
rename(scenario_0 = X1,
scenario_1 = X2,
scenario_2 = X3,
scenario_3 = X4,
scenario_4 = X5,
scenario_5 = X6,
scenario_6 = X7,
scenario_7 = X8,
scenario_8 = X9,
scenario_9 = X10,
scenario_10 = X11,
scenario_11 = X12,
scenario_12 = X13,
scenario_13 = X14)
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario_0 = median(scenario_0),
scenario_1 = median(scenario_1),
scenario_2 = median(scenario_2),
scenario_3 = median(scenario_3),
scenario_4 = median(scenario_4),
scenario_5 = median(scenario_5),
scenario_6 = median(scenario_6),
scenario_7 = median(scenario_7),
scenario_8 = median(scenario_8),
scenario_9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev_final = cbind(mean_prev_new,
scenario_0_seed = scenario_0$`local-seed`,
scenario_1_seed = scenario_1$`local-seed`,
scenario_2_seed = scenario_2$`local-seed`,
scenario_3_seed = scenario_3$`local-seed`,
scenario_4_seed = scenario_4$`local-seed`,
scenario_5_seed = scenario_5$`local-seed`,
scenario_6_seed = scenario_6$`local-seed`,
scenario_7_seed = scenario_7$`local-seed`,
scenario_8_seed = scenario_8$`local-seed`,
scenario_9_seed = scenario_9$`local-seed`,
scenario_10_seed = scenario_10$`local-seed`,
scenario_11_seed = scenario_11$`local-seed`,
scenario_12_seed = scenario_12$`local-seed`,
scenario_13_seed = scenario_13$`local-seed`)
mean_prev_new %>% view()
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario_0 = median(scenario_0),
scenario_1 = median(scenario_1),
scenario_2 = median(scenario_2),
scenario_3 = median(scenario_3),
scenario_4 = median(scenario_4),
scenario_5 = median(scenario_5),
scenario_6 = median(scenario_6),
scenario_7 = median(scenario_7),
scenario_8 = median(scenario_8),
scenario_9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev_final = cbind(mean_prev_new,
scenario_0_seed = scenario_0$`local-seed`,
scenario_1_seed = scenario_1$`local-seed`,
scenario_2_seed = scenario_2$`local-seed`,
scenario_3_seed = scenario_3$`local-seed`,
scenario_4_seed = scenario_4$`local-seed`,
scenario_5_seed = scenario_5$`local-seed`,
scenario_6_seed = scenario_6$`local-seed`,
scenario_7_seed = scenario_7$`local-seed`,
scenario_8_seed = scenario_8$`local-seed`,
scenario_9_seed = scenario_9$`local-seed`,
scenario_10_seed = scenario_10$`local-seed`,
scenario_11_seed = scenario_11$`local-seed`,
scenario_12_seed = scenario_12$`local-seed`,
scenario_13_seed = scenario_13$`local-seed`)
prev_dat = prev_result %>%
select(weekly_mean_prev)
prev_df = data.frame(matrix(NA, 4000, 14))
for (row in 1:14) {
start_row = (row - 1) * 4000 + 1
end_row = min(row * 4000, nrow(prev_dat))
prev_df[, row] = prev_dat$weekly_mean_prev[start_row:end_row]
}
mean_prev = prev_df %>%
rename(scenario_0 = X1,
scenario_1 = X2,
scenario_2 = X3,
scenario_3 = X4,
scenario_4 = X5,
scenario_5 = X6,
scenario_6 = X7,
scenario_7 = X8,
scenario_8 = X9,
scenario_9 = X10,
scenario_10 = X11,
scenario_11 = X12,
scenario_12 = X13,
scenario_13 = X14) %>%
colMeans() %>%
as.tibble() %>%
mutate(scenario = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13)) %>%
relocate(scenario, .before = value)
mean_prev %>% view()
prev_dat = prev_result %>%
select(weekly_mean_prev)
prev_df = data.frame(matrix(NA, 4000, 14))
for (row in 1:14) {
start_row = (row - 1) * 4000 + 1
end_row = min(row * 4000, nrow(prev_dat))
prev_df[, row] = prev_dat$weekly_mean_prev[start_row:end_row]
}
mean_prev = prev_df %>%
rename(scenario_0 = X1,
scenario_1 = X2,
scenario_2 = X3,
scenario_3 = X4,
scenario_4 = X5,
scenario_5 = X6,
scenario_6 = X7,
scenario_7 = X8,
scenario_8 = X9,
scenario_9 = X10,
scenario_10 = X11,
scenario_11 = X12,
scenario_12 = X13,
scenario_13 = X14)
mean_prev_summary = mean_prev %>%
colMeans() %>%
as.tibble() %>%
mutate(scenario = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13)) %>%
relocate(scenario, .before = value)
mean_prev %>% view()
mean_prev %>% view()
result %>% view()
prev_result %>% view()
prev_df %>% view()
mean_prev %>% view(\)
mean_prev %>% view()
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario_0 = median(scenario_0),
scenario_1 = median(scenario_1),
scenario_2 = median(scenario_2),
scenario_3 = median(scenario_3),
scenario_4 = median(scenario_4),
scenario_5 = median(scenario_5),
scenario_6 = median(scenario_6),
scenario_7 = median(scenario_7),
scenario_8 = median(scenario_8),
scenario_9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev_new %>% view()
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4)
mean_prev_new %>% view()
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario_0 = median(scenario_0),
scenario_1 = median(scenario_1),
scenario_2 = median(scenario_2),
scenario_3 = median(scenario_3),
scenario_4 = median(scenario_4),
scenario_5 = median(scenario_5),
scenario_6 = median(scenario_6),
scenario_7 = median(scenario_7),
scenario_8 = median(scenario_8),
scenario_9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev_new %>% view()
mean_prev_final = cbind(mean_prev_new,
scenario_0_seed = scenario_0$`local-seed`,
scenario_1_seed = scenario_1$`local-seed`,
scenario_2_seed = scenario_2$`local-seed`,
scenario_3_seed = scenario_3$`local-seed`,
scenario_4_seed = scenario_4$`local-seed`,
scenario_5_seed = scenario_5$`local-seed`,
scenario_6_seed = scenario_6$`local-seed`,
scenario_7_seed = scenario_7$`local-seed`,
scenario_8_seed = scenario_8$`local-seed`,
scenario_9_seed = scenario_9$`local-seed`,
scenario_10_seed = scenario_10$`local-seed`,
scenario_11_seed = scenario_11$`local-seed`,
scenario_12_seed = scenario_12$`local-seed`,
scenario_13_seed = scenario_13$`local-seed`)
#
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
#theme_classic() +
#scale_x_discrete(labels = c("cutting station", "dry display", "storage", "wet display")) +
#labs(title = substitute(paste(italic("Listeria "), "spp. prevalence by location")),
#    x = "Location", y = "Prevalence (%)") +
#theme(plot.title = element_text(hjust = 0.5),
#     legend.position = "none")
#ggsave("ABM_prev_by_location.tiff")
scenario_prev= gather(scenario_eff, c("scenario_0", "scenario_1_prev" , "scenario_2_prev" ,
"scenario_3_prev" , "scenario_4_prev" , "scenario_5_prev" , "scenario_6_prev" ,
"scenario_7_prev" , "scenario_8_prev" , "scenario_9_prev" , "scenario_10_prev",
"scenario_11_prev" ,"scenario_12_prev" ,"scenario_13_prev"),
key = "scenario", value = "prevalence")
#
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
#theme_classic() +
#scale_x_discrete(labels = c("cutting station", "dry display", "storage", "wet display")) +
#labs(title = substitute(paste(italic("Listeria "), "spp. prevalence by location")),
#    x = "Location", y = "Prevalence (%)") +
#theme(plot.title = element_text(hjust = 0.5),
#     legend.position = "none")
#ggsave("ABM_prev_by_location.tiff")
scenario_prev= gather(mean_prev_new, c("scenario_0", "scenario_1_prev" , "scenario_2_prev" ,
"scenario_3_prev" , "scenario_4_prev" , "scenario_5_prev" , "scenario_6_prev" ,
"scenario_7_prev" , "scenario_8_prev" , "scenario_9_prev" , "scenario_10_prev",
"scenario_11_prev" ,"scenario_12_prev" ,"scenario_13_prev"),
key = "scenario", value = "prevalence")
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario__0 = median(scenario_0),
scenario__1 = median(scenario_1),
scenario__2 = median(scenario_2),
scenario__3 = median(scenario_3),
scenario__4 = median(scenario_4),
scenario__5 = median(scenario_5),
scenario__6 = median(scenario_6),
scenario__7 = median(scenario_7),
scenario__8 = median(scenario_8),
scenario__9 = median(scenario_9),
scenario_10 = median(scenario_10),
scenario_11 = median(scenario_11),
scenario_12 = median(scenario_12),
scenario_13 = median(scenario_13)
) %>%
select(-Group)
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario__0 = mean(scenario_0),
scenario__1 = mean(scenario_1),
scenario__2 = mean(scenario_2),
scenario__3 = mean(scenario_3),
scenario__4 = mean(scenario_4),
scenario__5 = mean(scenario_5),
scenario__6 = mean(scenario_6),
scenario__7 = mean(scenario_7),
scenario__8 = mean(scenario_8),
scenario__9 = mean(scenario_9),
scenario_10 = mean(scenario_10),
scenario_11 = mean(scenario_11),
scenario_12 = mean(scenario_12),
scenario_13 = mean(scenario_13)
) %>%
select(-Group)
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
scenario_plot
#ggsave("ABM_Scenario_Mean_Prev.tiff")
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario__0 = mean(scenario_0),
scenario__1 = mean(scenario_1),
scenario__2 = mean(scenario_2),
scenario__3 = mean(scenario_3),
scenario__4 = mean(scenario_4),
scenario__5 = mean(scenario_5),
scenario__6 = mean(scenario_6),
scenario__7 = mean(scenario_7),
scenario__8 = mean(scenario_8),
scenario__9 = mean(scenario_9),
scenario_10 = mean(scenario_10),
scenario_11 = mean(scenario_11),
scenario_12 = mean(scenario_12),
scenario_13 = mean(scenario_13)
) %>%
select(-Group)
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
scenario_plot
#ggsave("ABM_Scenario_Mean_Prev.tiff")
#
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
#ggsave("ABM_Scenario_Mean_Prev.tiff")
scenario_prev = scenario_prev %>%
mutate(scenario = replace(scenario, scenario == 'scenario_0_prev', "scenario_0")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_1_prev', "scenario_1")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_2_prev', "scenario_2")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_3_prev', "scenario_3")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_4_prev', "scenario_4")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_5_prev', "scenario_5")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_6_prev', "scenario_6")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_7_prev', "scenario_7")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_8_prev', "scenario_8")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_9_prev', "scenario_9")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_10_prev', "scenario_10")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_11_prev', "scenario_11")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_12_prev', "scenario_12")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_13_prev', "scenario_13"))
#
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
#ggsave("ABM_Scenario_Mean_Prev.tiff")
scenario_prev = scenario_prev %>%
mutate(scenario = replace(scenario, scenario == 'scenario_0_prev', "scenario_0")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_1_prev', "scenario_1")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_2_prev', "scenario_2")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_3_prev', "scenario_3")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_4_prev', "scenario_4")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_5_prev', "scenario_5")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_6_prev', "scenario_6")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_7_prev', "scenario_7")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_8_prev', "scenario_8")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_9_prev', "scenario_9")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_10_prev', "scenario_10")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_11_prev', "scenario_11")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_12_prev', "scenario_12")) %>%
mutate(scenario = replace(scenario, scenario == 'scenario_13_prev', "scenario_13"))
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
#
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
#ggsave("ABM_Scenario_Mean_Prev.tiff")
scenario_prev= gather(mean_prev_new, c("scenario_0", "scenario_1_prev" , "scenario_2_prev" ,
"scenario_3_prev" , "scenario_4_prev" , "scenario_5_prev" , "scenario_6_prev" ,
"scenario_7_prev" , "scenario_8_prev" , "scenario_9_prev" , "scenario_10_prev",
"scenario_11_prev" ,"scenario_12_prev" ,"scenario_13_prev"),
key = "scenario", value = "prevalence")
#
scenario_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
#ggsave("ABM_Scenario_Mean_Prev.tiff")
scenario_prev= gather(mean_prev_new, c("scenario_0", "scenario_1_prev" , "scenario_2_prev" ,
"scenario_3_prev" , "scenario_4_prev" , "scenario_5_prev" , "scenario_6_prev" ,
"scenario_7_prev" , "scenario_8_prev" , "scenario_9_prev" , "scenario_10_prev",
"scenario_11_prev" ,"scenario_12_prev" ,"scenario_13_prev"),
key = "scenario", value = "prevalence")
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
prev_dat = prev_result %>%
select(weekly_mean_prev)
prev_df = data.frame(matrix(NA, 4000, 14))
for (row in 1:14) {
start_row = (row - 1) * 4000 + 1
end_row = min(row * 4000, nrow(prev_dat))
prev_df[, row] = prev_dat$weekly_mean_prev[start_row:end_row]
}
mean_prev = prev_df %>%
rename(scenario_0 = X1,
scenario_1 = X2,
scenario_2 = X3,
scenario_3 = X4,
scenario_4 = X5,
scenario_5 = X6,
scenario_6 = X7,
scenario_7 = X8,
scenario_8 = X9,
scenario_9 = X10,
scenario_10 = X11,
scenario_11 = X12,
scenario_12 = X13,
scenario_13 = X14)
mean_prev_summary = mean_prev %>%
colMeans() %>%
as.tibble() %>%
mutate(scenario = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13)) %>%
relocate(scenario, .before = value)
mean_prev$Row_Index = 1:nrow(mean_prev)
mean_prev_new = mean_prev %>%
group_by(Group = (Row_Index - 1) %/% 4) %>%
summarize(
scenario__0 = mean(scenario_0),
scenario__1 = mean(scenario_1),
scenario__2 = mean(scenario_2),
scenario__3 = mean(scenario_3),
scenario__4 = mean(scenario_4),
scenario__5 = mean(scenario_5),
scenario__6 = mean(scenario_6),
scenario__7 = mean(scenario_7),
scenario__8 = mean(scenario_8),
scenario__9 = mean(scenario_9),
scenario_10 = mean(scenario_10),
scenario_11 = mean(scenario_11),
scenario_12 = mean(scenario_12),
scenario_13 = mean(scenario_13)
) %>%
select(-Group)
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value))
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot
mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
mean_prev_new %>% view()
#
scenario_prev_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
scenario_prev_plot
#ggsave("scenario_prev_plot.tiff", width = 10, height = 6)
naova_results <- lapply(mean_prev_new, function(column) {
aov_result <- aov(column ~ 1)  # 1 indicates no explanatory variable, just the intercept
return(summary(aov_result))
})
# Print ANOVA results
for (i in seq_along(anova_results)) {
cat("ANOVA results for Column", i, ":\n")
print(anova_results[[i]])
cat("\n")
}
anova_results <- lapply(mean_prev_new, function(column) {
aov_result <- aov(column ~ 1)  # 1 indicates no explanatory variable, just the intercept
return(summary(aov_result))
})
# Print ANOVA results
for (i in seq_along(anova_results)) {
cat("ANOVA results for Column", i, ":\n")
print(anova_results[[i]])
cat("\n")
}
summary(aov(mean_prev_new))
summary(aov(data = mean_prev_new))
?aov
aov(data = mean_prev_new)
aov(mean_prev_new)
colnames(mean_prev_new)
scenario_prev_plot = mean_prev_new %>%
gather(key = scenario) %>%
ggplot(aes(x = scenario, y = value)) +
geom_boxplot()
scenario_prev_plot
#ggsave("scenario_prev_plot.tiff", width = 10, height = 6)
mean_prev_summary %>% view()
